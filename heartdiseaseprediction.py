# -*- coding: utf-8 -*-
"""HeartDiseasePrediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/17o5O21CgLEqEEmfsWS7UQ5OCuxOnBzwy
"""

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

from google.colab import drive
drive.mount('/content/drive')

"""Data Collection and Processing"""

heart_data = pd.read_csv('/content/drive/MyDrive/heart.csv')

heart_data.head()

heart_data.tail()

heart_data.shape

# getting some info about the data
heart_data.info()

# checking missing values
heart_data.isnull().sum()

heart_data.describe()

heart_data['target'].value_counts()

"""1---> Defective Heart

2---> Healthy Heart
"""

X = heart_data.drop(columns = 'target', axis =1)
Y = heart_data['target']

"""Splitting the data into test and train data"""

X_train,X_test,Y_train,Y_test = train_test_split(X,Y,test_size=0.2,stratify=Y,random_state=2)
#if we do not put stratify=Y it will split data in such a way that either one of them contain only 1 or only 0

print(X.shape,X_train.shape,X_test.shape)

print(Y.shape,Y_train.shape,Y_test.shape)

"""Model Training

Logistic Regression
"""

model = LogisticRegression()

#training the LogisticRegression model with Training data
model.fit(X_train, Y_train)

"""Model Evaluation

Accuracy Score
"""

#accuracy on training data
X_train_prediction = model.predict(X_train)
training_data_accuracy = accuracy_score(X_train_prediction, Y_train)

print("Accuracy of training data : " , training_data_accuracy)

#accuracy on testing data
X_test_prediction = model.predict(X_test)
testing_data_accuracy = accuracy_score(X_test_prediction, Y_test)

print("Accuracy of testing data : " , testing_data_accuracy)

"""Building Predicting System"""

input_data = (58,1,0,114,318,0,2,140,0,4.4,0,3,1)

#changing the input_data to a numpy array
input_data_as_numpy_array = np.asarray(input_data)

#reshape the np array as we are predicting for one instance
input_data_reshaped = input_data_as_numpy_array.reshape(1,-1)

prediction = model.predict(input_data_reshaped)
print(prediction) #prediction is a form of list

if(prediction[0]== 1): print("The person has defective heart")
else : print("The person is healthy")

"""Saving the trained model"""

import pickle

filename = 'trained_model.sav'
pickle.dump(model,open(filename,'wb'))

#loading the saved model
loaded_model = pickle.load(open('trained_model.sav','rb'))

input_data = (58,1,0,114,318,0,2,140,0,4.4,0,3,1)

#changing the input_data to a numpy array
input_data_as_numpy_array = np.asarray(input_data)

#reshape the np array as we are predicting for one instance
input_data_reshaped = input_data_as_numpy_array.reshape(1,-1)

prediction = loaded_model.predict(input_data_reshaped)
print(prediction) #prediction is a form of list

if(prediction[0]== 1): print("The person has defective heart")
else : print("The person is healthy")